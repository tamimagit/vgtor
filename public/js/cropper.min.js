(function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?e(require("jquery")):e(jQuery)})(function(t){'use strict';function e(e){return"number"==typeof e&&!isNaN(e)}function i(e){return"undefined"==typeof e}function o(t,i){var o=[];return e(i)&&o.push(i),o.slice.apply(t,o)}function a(e,t){var i=o(arguments,2);return function(){return e.apply(t,i.concat(o(arguments)))}}function n(e){var t=e.match(/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i);return t&&(t[1]!==C.protocol||t[2]!==C.hostname||t[3]!==C.port)}function r(e){var t="timestamp="+new Date().getTime();return e+(-1===e.indexOf("?")?"?":"&")+t}function s(e){return e?" crossOrigin=\""+e+"\"":""}function d(e,t){var i;return e.naturalWidth&&!he?t(e.naturalWidth,e.naturalHeight):void(i=document.createElement("img"),i.onload=function(){t(this.width,this.height)},i.src=e.src)}function p(t){var i=[],o=t.rotate,a=t.scaleX,n=t.scaleY;return e(o)&&0!==o&&i.push("rotate("+o+"deg)"),e(a)&&1!==a&&i.push("scaleX("+a+")"),e(n)&&1!==n&&i.push("scaleY("+n+")"),i.length?i.join(" "):"none"}function h(e,t){var i,o,a=me(e.degree)%180,n=(90<a?180-a:a)*Math.PI/180,r=fe(n),s=ue(n),d=e.width,p=e.height,h=e.aspectRatio;return t?(i=d/(s+r/h),o=i/h):(i=d*s+p*r,o=d*r+p*s),{width:i,height:o}}function l(i,o){var a,n,r,s=t("<canvas>")[0],d=s.getContext("2d"),p=0,l=0,c=o.naturalWidth,g=o.naturalHeight,m=o.rotate,f=o.scaleX,u=o.scaleY,x=e(f)&&e(u)&&(1!==f||1!==u),w=e(m)&&0!==m,v=w||x,C=c*me(f||1),b=g*me(u||1);return x&&(a=C/2,n=b/2),w&&(r=h({width:C,height:b,degree:m}),C=r.width,b=r.height,a=C/2,n=b/2),s.width=C,s.height=b,v&&(p=-c/2,l=-g/2,d.save(),d.translate(a,n)),w&&d.rotate(m*Math.PI/180),x&&d.scale(f,u),d.drawImage(i,ve(p),ve(l),ve(c),ve(g)),v&&d.restore(),s}function c(e){var i=e.length,o=0,a=0;return i&&(t.each(e,function(e,t){o+=t.pageX,a+=t.pageY}),o/=i,a/=i),{pageX:o,pageY:a}}function g(e,t,o){var a,n="";for(a=t,o+=t;a<o;a++)n+=Ce(e.getUint8(a));return n}function m(e){var t,o,a,n,r,s,d,p,h,l,c=new y(e),m=c.byteLength;if(255===c.getUint8(0)&&216===c.getUint8(1))for(h=2;h<m;){if(255===c.getUint8(h)&&225===c.getUint8(h+1)){d=h;break}h++}if(d&&(o=d+4,a=d+10,"Exif"===g(c,o,4)&&(s=c.getUint16(a),r=18761===s,(r||19789===s)&&42===c.getUint16(a+2,r)&&(n=c.getUint32(a+4,r),8<=n&&(p=a+n)))),p)for(m=c.getUint16(p,r),l=0;l<m;l++)if(h=p+12*l+2,274===c.getUint16(h,r)){h+=8,t=c.getUint16(h,r),he&&c.setUint16(h,1,r);break}return t}function f(e){var t,o=e.replace(K,""),a=atob(o),n=a.length,r=new B(n),s=new D(r);for(t=0;t<n;t++)s[t]=a.charCodeAt(t);return r}function u(e){var t,o=new D(e),a=o.length,n="";for(t=0;t<a;t++)n+=Ce(o[t]);return"data:image/jpeg;base64,"+$(n)}function x(e,i){this.$element=t(e),this.options=t.extend({},x.DEFAULTS,t.isPlainObject(i)&&i),this.isLoaded=!1,this.isBuilt=!1,this.isCompleted=!1,this.isRotated=!1,this.isCropped=!1,this.isDisabled=!1,this.isReplaced=!1,this.isLimited=!1,this.wheeling=!1,this.isImg=!1,this.originalUrl="",this.canvas=null,this.cropBox=null,this.init()}var w=t(window),v=t(document),C=window.location,b=window.navigator,B=window.ArrayBuffer,D=window.Uint8Array,y=window.DataView,$=window.btoa,L="cropper",Y="cropper-modal",X="cropper-hide",T="cropper-hidden",W="cropper-move",H="cropper-crop",R="cropper-disabled",z="mousedown touchstart pointerdown MSPointerDown",M="mousemove touchmove pointermove MSPointerMove",O="mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",E="wheel mousewheel DOMMouseScroll",P="dblclick",U="load."+L,I="error."+L,F="resize."+L,k="build."+L,A="built."+L,j="cropstart."+L,S="cropmove."+L,_="cropend."+L,q="crop."+L,Z="zoom."+L,K=/^data:([^;]+);base64,/,V="preview",G="action",J="e",N="w",Q="s",ee="n",te="se",ie="sw",oe="ne",ae="nw",ne="all",re="crop",se="move",de="zoom",pe=t.isFunction(t("<canvas>")[0].getContext),he=b&&/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(b.userAgent),le=Number,ce=Math.min,ge=Math.max,me=Math.abs,fe=Math.sin,ue=Math.cos,xe=Math.sqrt,we=Math.round,ve=Math.floor,Ce=String.fromCharCode;x.prototype={constructor:x,init:function(){var e,t=this.$element;if(t.is("img")){if(this.isImg=!0,this.originalUrl=e=t.attr("src"),!e)return;e=t.prop("src")}else t.is("canvas")&&pe&&(e=t[0].toDataURL());this.load(e)},trigger:function(i,o){var a=t.Event(i,o);return this.$element.trigger(a),a},load:function(e){var i,o,a=this.options,s=this.$element;if(e)return(s.one(k,a.build),!this.trigger(k).isDefaultPrevented())?(this.url=e,this.image={},!a.checkOrientation||!B)?this.clone():(i=t.proxy(this.read,this),/^data:/.test(e)?/^data:image\/jpeg.*;base64,/.test(e)?i(f(e)):this.clone():void(o=new XMLHttpRequest,o.onerror=o.onabort=t.proxy(function(){this.clone()},this),o.onload=function(){i(this.response)},a.checkCrossOrigin&&n(e)&&s.prop("crossOrigin")&&(e=r(e)),o.open("get",e),o.responseType="arraybuffer",o.send())):void 0},read:function(e){var t=this.options,i=m(e),o=this.image,a=0,n=1,r=1;1<i&&(this.url=u(e),2===i?n=-1:3===i?a=-180:4===i?r=-1:5===i?(a=90,r=-1):6===i?a=90:7===i?(a=90,n=-1):8===i?a=-90:void 0);t.rotatable&&(o.rotate=a),t.scalable&&(o.scaleX=n,o.scaleY=r),this.clone()},clone:function(){var e,i,o=this.options,a=this.$element,d=this.url,p="";o.checkCrossOrigin&&n(d)&&(p=a.prop("crossOrigin"),p?e=d:(p="anonymous",e=r(d))),this.crossOrigin=p,this.crossOriginUrl=e,this.$clone=i=t("<img"+s(p)+" src=\""+(e||d)+"\">"),this.isImg?a[0].complete?this.start():a.one(U,t.proxy(this.start,this)):i.one(U,t.proxy(this.start,this)).one(I,t.proxy(this.stop,this)).addClass(X).insertAfter(a)},start:function(){var e=this.$element,i=this.$clone;this.isImg||(i.off(I,this.stop),e=i),d(e[0],t.proxy(function(e,i){t.extend(this.image,{naturalWidth:e,naturalHeight:i,aspectRatio:e/i}),this.isLoaded=!0,this.build()},this))},stop:function(){this.$clone.remove(),this.$clone=null},build:function(){var e,i,o,a=this.options,n=this.$element,r=this.$clone;this.isLoaded&&(this.isBuilt&&this.unbuild(),this.$container=n.parent(),this.$cropper=e=t(x.TEMPLATE),this.$canvas=e.find(".cropper-canvas").append(r),this.$dragBox=e.find(".cropper-drag-box"),this.$cropBox=i=e.find(".cropper-crop-box"),this.$viewBox=e.find(".cropper-view-box"),this.$face=o=i.find(".cropper-face"),n.addClass(T).after(e),!this.isImg&&r.removeClass(X),this.initPreview(),this.bind(),a.aspectRatio=ge(0,a.aspectRatio)||NaN,a.viewMode=ge(0,ce(3,we(a.viewMode)))||0,a.autoCrop?(this.isCropped=!0,a.modal&&this.$dragBox.addClass(Y)):i.addClass(T),!a.guides&&i.find(".cropper-dashed").addClass(T),!a.center&&i.find(".cropper-center").addClass(T),a.cropBoxMovable&&o.addClass(W).data(G,ne),!a.highlight&&o.addClass("cropper-invisible"),a.background&&e.addClass("cropper-bg"),!a.cropBoxResizable&&i.find(".cropper-line, .cropper-point").addClass(T),this.setDragMode(a.dragMode),this.render(),this.isBuilt=!0,this.setData(a.data),n.one(A,a.built),setTimeout(t.proxy(function(){this.trigger(A),this.trigger(q,this.getData()),this.isCompleted=!0},this),0))},unbuild:function(){this.isBuilt&&(this.isBuilt=!1,this.isCompleted=!1,this.initialImage=null,this.initialCanvas=null,this.initialCropBox=null,this.container=null,this.canvas=null,this.cropBox=null,this.unbind(),this.resetPreview(),this.$preview=null,this.$viewBox=null,this.$cropBox=null,this.$dragBox=null,this.$canvas=null,this.$container=null,this.$cropper.remove(),this.$cropper=null)},render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.isCropped&&this.renderCropBox()},initContainer:function(){var e=this.options,t=this.$element,i=this.$container,o=this.$cropper;o.addClass(T),t.removeClass(T);let a=420<window.innerWidth?980<parseInt(.8*window.innerWidth)?980:parseInt(.8*window.innerWidth):parseInt(.9*window.innerWidth),n=450>window.innerWidth?parseInt(.6*window.innerHeight):parseInt(.7*window.innerHeight);o.css(this.container={width:a,height:n}),t.addClass(T),o.removeClass(T)},initCanvas:function(){var e,i=this.options.viewMode,o=this.container,a=o.width,n=o.height,r=this.image,s=r.naturalWidth,d=r.naturalHeight,p=90===me(r.rotate),h=p?d:s,l=p?s:d,c=h/l,g=a,m=n;n*c>a?3===i?g=n*c:m=a/c:3===i?m=a/c:g=n*c,e={naturalWidth:h,naturalHeight:l,aspectRatio:c,width:g,height:m},e.oldLeft=e.left=(a-g)/2,e.oldTop=e.top=(n-m)/2,this.canvas=e,this.isLimited=1===i||2===i,this.limitCanvas(!0,!0),this.initialImage=t.extend({},r),this.initialCanvas=t.extend({},e)},limitCanvas:function(e,t){var i,o,a,n,r=this.options,s=r.viewMode,d=this.container,p=d.width,h=d.height,l=this.canvas,c=l.aspectRatio,g=this.cropBox,m=this.isCropped&&g;e&&(i=le(r.minCanvasWidth)||0,o=le(r.minCanvasHeight)||0,s&&(1<s?(i=ge(i,p),o=ge(o,h),3===s&&(o*c>i?i=o*c:o=i/c)):i?i=ge(i,m?g.width:0):o?o=ge(o,m?g.height:0):m&&(i=g.width,o=g.height,o*c>i?i=o*c:o=i/c)),i&&o?o*c>i?o=i/c:i=o*c:i?o=i/c:o&&(i=o*c),l.minWidth=i,l.minHeight=o,l.maxWidth=1/0,l.maxHeight=1/0),t&&(s?(a=p-l.width,n=h-l.height,l.minLeft=ce(0,a),l.minTop=ce(0,n),l.maxLeft=ge(0,a),l.maxTop=ge(0,n),m&&this.isLimited&&(l.minLeft=ce(g.left,g.left+g.width-l.width),l.minTop=ce(g.top,g.top+g.height-l.height),l.maxLeft=g.left,l.maxTop=g.top,2===s&&(l.width>=p&&(l.minLeft=ce(0,a),l.maxLeft=ge(0,a)),l.height>=h&&(l.minTop=ce(0,n),l.maxTop=ge(0,n))))):(l.minLeft=-l.width,l.minTop=-l.height,l.maxLeft=p,l.maxTop=h))},renderCanvas:function(e){var t,i,o=this.canvas,a=this.image,n=a.rotate,r=a.naturalWidth,s=a.naturalHeight;this.isRotated&&(this.isRotated=!1,i=h({width:a.width,height:a.height,degree:n}),t=i.width/i.height,t!==o.aspectRatio&&(o.left-=(i.width-o.width)/2,o.top-=(i.height-o.height)/2,o.width=i.width,o.height=i.height,o.aspectRatio=t,o.naturalWidth=r,o.naturalHeight=s,n%180&&(i=h({width:r,height:s,degree:n}),o.naturalWidth=i.width,o.naturalHeight=i.height),this.limitCanvas(!0,!1))),(o.width>o.maxWidth||o.width<o.minWidth)&&(o.left=o.oldLeft),(o.height>o.maxHeight||o.height<o.minHeight)&&(o.top=o.oldTop),o.width=ce(ge(o.width,o.minWidth),o.maxWidth),o.height=ce(ge(o.height,o.minHeight),o.maxHeight),this.limitCanvas(!1,!0),o.oldLeft=o.left=ce(ge(o.left,o.minLeft),o.maxLeft),o.oldTop=o.top=ce(ge(o.top,o.minTop),o.maxTop),this.$canvas.css({width:o.width,height:o.height,left:o.left,top:o.top}),this.renderImage(),this.isCropped&&this.isLimited&&this.limitCropBox(!0,!0),e&&this.output()},renderImage:function(e){var i,o=this.canvas,a=this.image;a.rotate&&(i=h({width:o.width,height:o.height,degree:a.rotate,aspectRatio:a.aspectRatio},!0)),t.extend(a,i?{width:i.width,height:i.height,left:(o.width-i.width)/2,top:(o.height-i.height)/2}:{width:o.width,height:o.height,left:0,top:0}),this.$clone.css({width:a.width,height:a.height,marginLeft:a.left,marginTop:a.top,transform:p(a)}),e&&this.output()},initCropBox:function(){var e=this.options,i=this.canvas,o=e.aspectRatio,a=le(e.autoCropArea)||.8,n={width:i.width,height:i.height};o&&(i.height*o>i.width?n.height=n.width/o:n.width=n.height*o),this.cropBox=n,this.limitCropBox(!0,!0),n.width=ce(ge(n.width,n.minWidth),n.maxWidth),n.height=ce(ge(n.height,n.minHeight),n.maxHeight),n.width=ge(n.minWidth,n.width*a),n.height=ge(n.minHeight,n.height*a),n.oldLeft=n.left=i.left+(i.width-n.width)/2,n.oldTop=n.top=i.top+(i.height-n.height)/2,this.initialCropBox=t.extend({},n)},limitCropBox:function(e,t){var i,o,a,n,r=this.options,s=r.aspectRatio,d=this.container,p=d.width,h=d.height,l=this.canvas,c=this.cropBox,g=this.isLimited;e&&(i=le(r.minCropBoxWidth)||0,o=le(r.minCropBoxHeight)||0,i=ce(i,p),o=ce(o,h),a=ce(p,g?l.width:p),n=ce(h,g?l.height:h),s&&(i&&o?o*s>i?o=i/s:i=o*s:i?o=i/s:o&&(i=o*s),n*s>a?n=a/s:a=n*s),c.minWidth=ce(i,a),c.minHeight=ce(o,n),c.maxWidth=a,c.maxHeight=n),t&&(g?(c.minLeft=ge(0,l.left),c.minTop=ge(0,l.top),c.maxLeft=ce(p,l.left+l.width)-c.width,c.maxTop=ce(h,l.top+l.height)-c.height):(c.minLeft=0,c.minTop=0,c.maxLeft=p-c.width,c.maxTop=h-c.height))},renderCropBox:function(){var e=this.options,t=this.container,i=t.width,o=t.height,a=this.cropBox;(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft),(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop),a.width=ce(ge(a.width,a.minWidth),a.maxWidth),a.height=ce(ge(a.height,a.minHeight),a.maxHeight),this.limitCropBox(!1,!0),a.oldLeft=a.left=ce(ge(a.left,a.minLeft),a.maxLeft),a.oldTop=a.top=ce(ge(a.top,a.minTop),a.maxTop),e.movable&&e.cropBoxMovable&&this.$face.data(G,a.width===i&&a.height===o?se:ne),this.$cropBox.css({width:a.width,height:a.height,left:a.left,top:a.top}),this.isCropped&&this.isLimited&&this.limitCanvas(!0,!0),this.isDisabled||this.output()},output:function(){this.preview(),this.isCompleted&&this.trigger(q,this.getData())},initPreview:function(){var e,i=s(this.crossOrigin),o=i?this.crossOriginUrl:this.url;this.$preview=t(this.options.preview),this.$clone2=e=t("<img"+i+" src=\""+o+"\">"),this.$viewBox.html(e),this.$preview.each(function(){var e=t(this);e.data(V,{width:e.width(),height:e.height(),html:e.html()}),e.html("<img"+i+" src=\""+o+"\" style=\"display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;\">")})},resetPreview:function(){this.$preview.each(function(){var e=t(this),i=e.data(V);e.css({width:i.width,height:i.height}).html(i.html).removeData(V)})},preview:function(){var e=this.image,i=this.canvas,o=this.cropBox,a=o.width,n=o.height,r=e.width,s=e.height,d=o.left-i.left-e.left,h=o.top-i.top-e.top;!this.isCropped||this.isDisabled||(this.$clone2.css({width:r,height:s,marginLeft:-d,marginTop:-h,transform:p(e)}),this.$preview.each(function(){var i=t(this),o=i.data(V),l=o.width,c=o.height,g=l,m=c,f=1;a&&(f=l/a,m=n*f),n&&m>c&&(f=c/n,g=a*f,m=c),i.css({width:g,height:m}).find("img").css({width:r*f,height:s*f,marginLeft:-d*f,marginTop:-h*f,transform:p(e)})}))},bind:function(){var e=this.options,i=this.$element,o=this.$cropper;t.isFunction(e.cropstart)&&i.on(j,e.cropstart),t.isFunction(e.cropmove)&&i.on(S,e.cropmove),t.isFunction(e.cropend)&&i.on(_,e.cropend),t.isFunction(e.crop)&&i.on(q,e.crop),t.isFunction(e.zoom)&&i.on(Z,e.zoom),o.on(z,t.proxy(this.cropStart,this)),e.zoomable&&e.zoomOnWheel&&o.on(E,t.proxy(this.wheel,this)),e.toggleDragModeOnDblclick&&o.on(P,t.proxy(this.dblclick,this)),v.on(M,this._cropMove=a(this.cropMove,this)).on(O,this._cropEnd=a(this.cropEnd,this)),e.responsive&&w.on(F,this._resize=a(this.resize,this))},unbind:function(){var e=this.options,i=this.$element,o=this.$cropper;t.isFunction(e.cropstart)&&i.off(j,e.cropstart),t.isFunction(e.cropmove)&&i.off(S,e.cropmove),t.isFunction(e.cropend)&&i.off(_,e.cropend),t.isFunction(e.crop)&&i.off(q,e.crop),t.isFunction(e.zoom)&&i.off(Z,e.zoom),o.off(z,this.cropStart),e.zoomable&&e.zoomOnWheel&&o.off(E,this.wheel),e.toggleDragModeOnDblclick&&o.off(P,this.dblclick),v.off(M,this._cropMove).off(O,this._cropEnd),e.responsive&&w.off(F,this._resize)},resize:function(){var e,o,a,n=this.options.restore,r=this.$container,s=this.container;this.isDisabled||!s||(a=r.width()/s.width,(1!==a||r.height()!==s.height)&&(n&&(e=this.getCanvasData(),o=this.getCropBoxData()),this.render(),n&&(this.setCanvasData(t.each(e,function(t,i){e[t]=i*a})),this.setCropBoxData(t.each(o,function(e,t){o[e]=t*a})))))},dblclick:function(){this.isDisabled||(this.$dragBox.hasClass(H)?this.setDragMode(se):this.setDragMode(re))},wheel:function(i){var o=i.originalEvent||i,e=le(this.options.wheelZoomRatio)||.1,a=1;this.isDisabled||(i.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout(t.proxy(function(){this.wheeling=!1},this),50),o.deltaY?a=0<o.deltaY?1:-1:o.wheelDelta?a=-o.wheelDelta/120:o.detail&&(a=0<o.detail?1:-1),this.zoom(-a*e,i)))},cropStart:function(i){var o,a,n=this.options,r=i.originalEvent,s=r&&r.touches,d=i;if(!this.isDisabled){if(s){if(o=s.length,1<o)if(n.zoomable&&n.zoomOnTouch&&2===o)d=s[1],this.startX2=d.pageX,this.startY2=d.pageY,a=de;else return;d=s[0]}if(a=a||t(d.target).data(G),/^(e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/.test(a)){if(this.trigger(j,{originalEvent:r,action:a}).isDefaultPrevented())return;i.preventDefault(),this.action=a,this.cropping=!1,this.startX=d.pageX||r&&r.pageX,this.startY=d.pageY||r&&r.pageY,a===re&&(this.cropping=!0,this.$dragBox.addClass(Y))}}},cropMove:function(t){var i,o=this.options,a=t.originalEvent,n=a&&a.touches,r=t,s=this.action;if(!this.isDisabled){if(n){if(i=n.length,1<i)if(o.zoomable&&o.zoomOnTouch&&2===i)r=n[1],this.endX2=r.pageX,this.endY2=r.pageY;else return;r=n[0]}if(s){if(this.trigger(S,{originalEvent:a,action:s}).isDefaultPrevented())return;t.preventDefault(),this.endX=r.pageX||a&&a.pageX,this.endY=r.pageY||a&&a.pageY,this.change(r.shiftKey,s===de?t:null)}}},cropEnd:function(e){var t=e.originalEvent,i=this.action;this.isDisabled||i&&(e.preventDefault(),this.cropping&&(this.cropping=!1,this.$dragBox.toggleClass(Y,this.isCropped&&this.options.modal)),this.action="",this.trigger(_,{originalEvent:t,action:i}))},change:function(e,t){var i,o,a=this.options,n=a.aspectRatio,r=this.action,s=this.container,d=this.canvas,p=this.cropBox,h=p.width,l=p.height,c=p.left,g=p.top,m=c+h,f=g+l,u=0,x=0,w=s.width,v=s.height,C=!0;switch(!n&&e&&(n=h&&l?h/l:1),this.isLimited&&(u=p.minLeft,x=p.minTop,w=u+ce(s.width,d.left+d.width),v=x+ce(s.height,d.top+d.height)),o={x:this.endX-this.startX,y:this.endY-this.startY},n&&(o.X=o.y*n,o.Y=o.x/n),r){case ne:c+=o.x,g+=o.y;break;case J:if(0<=o.x&&(m>=w||n&&(g<=x||f>=v))){C=!1;break}h+=o.x,n&&(l=h/n,g-=o.Y/2),0>h&&(r=N,h=0);break;case ee:if(0>=o.y&&(g<=x||n&&(c<=u||m>=w))){C=!1;break}l-=o.y,g+=o.y,n&&(h=l*n,c+=o.X/2),0>l&&(r=Q,l=0);break;case N:if(0>=o.x&&(c<=u||n&&(g<=x||f>=v))){C=!1;break}h-=o.x,c+=o.x,n&&(l=h/n,g+=o.Y/2),0>h&&(r=J,h=0);break;case Q:if(0<=o.y&&(f>=v||n&&(c<=u||m>=w))){C=!1;break}l+=o.y,n&&(h=l*n,c-=o.X/2),0>l&&(r=ee,l=0);break;case oe:if(n){if(0>=o.y&&(g<=x||m>=w)){C=!1;break}l-=o.y,g+=o.y,h=l*n}else 0<=o.x?m<w?h+=o.x:0>=o.y&&g<=x&&(C=!1):h+=o.x,0>=o.y?g>x&&(l-=o.y,g+=o.y):(l-=o.y,g+=o.y);0>h&&0>l?(r=ie,l=0,h=0):0>h?(r=ae,h=0):0>l&&(r=te,l=0);break;case ae:if(n){if(0>=o.y&&(g<=x||c<=u)){C=!1;break}l-=o.y,g+=o.y,h=l*n,c+=o.X}else 0>=o.x?c>u?(h-=o.x,c+=o.x):0>=o.y&&g<=x&&(C=!1):(h-=o.x,c+=o.x),0>=o.y?g>x&&(l-=o.y,g+=o.y):(l-=o.y,g+=o.y);0>h&&0>l?(r=te,l=0,h=0):0>h?(r=oe,h=0):0>l&&(r=ie,l=0);break;case ie:if(n){if(0>=o.x&&(c<=u||f>=v)){C=!1;break}h-=o.x,c+=o.x,l=h/n}else 0>=o.x?c>u?(h-=o.x,c+=o.x):0<=o.y&&f>=v&&(C=!1):(h-=o.x,c+=o.x),0<=o.y?f<v&&(l+=o.y):l+=o.y;0>h&&0>l?(r=oe,l=0,h=0):0>h?(r=te,h=0):0>l&&(r=ae,l=0);break;case te:if(n){if(0<=o.x&&(m>=w||f>=v)){C=!1;break}h+=o.x,l=h/n}else 0<=o.x?m<w?h+=o.x:0<=o.y&&f>=v&&(C=!1):h+=o.x,0<=o.y?f<v&&(l+=o.y):l+=o.y;0>h&&0>l?(r=ae,l=0,h=0):0>h?(r=ie,h=0):0>l&&(r=oe,l=0);break;case se:this.move(o.x,o.y),C=!1;break;case de:this.zoom(function(e,t,i,o){var a=xe(e*e+t*t),n=xe(i*i+o*o);return(n-a)/a}(me(this.startX-this.startX2),me(this.startY-this.startY2),me(this.endX-this.endX2),me(this.endY-this.endY2)),t),this.startX2=this.endX2,this.startY2=this.endY2,C=!1;break;case re:if(!o.x||!o.y){C=!1;break}i=this.$cropper.offset(),c=this.startX-i.left,g=this.startY-i.top,h=p.minWidth,l=p.minHeight,0<o.x?r=0<o.y?te:oe:0>o.x&&(c-=h,r=0<o.y?ie:ae),0>o.y&&(g-=l),this.isCropped||(this.$cropBox.removeClass(T),this.isCropped=!0,this.isLimited&&this.limitCropBox(!0,!0));}C&&(p.width=h,p.height=l,p.left=c,p.top=g,this.action=r,this.renderCropBox()),this.startX=this.endX,this.startY=this.endY},crop:function(){!this.isBuilt||this.isDisabled||(!this.isCropped&&(this.isCropped=!0,this.limitCropBox(!0,!0),this.options.modal&&this.$dragBox.addClass(Y),this.$cropBox.removeClass(T)),this.setCropBoxData(this.initialCropBox))},reset:function(){!this.isBuilt||this.isDisabled||(this.image=t.extend({},this.initialImage),this.canvas=t.extend({},this.initialCanvas),this.cropBox=t.extend({},this.initialCropBox),this.renderCanvas(),this.isCropped&&this.renderCropBox())},clear:function(){!this.isCropped||this.isDisabled||(t.extend(this.cropBox,{left:0,top:0,width:0,height:0}),this.isCropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),this.$dragBox.removeClass(Y),this.$cropBox.addClass(T))},replace:function(e,t){!this.isDisabled&&e&&(this.isImg&&this.$element.attr("src",e),t?(this.url=e,this.$clone.attr("src",e),this.isBuilt&&this.$preview.find("img").add(this.$clone2).attr("src",e)):(this.isImg&&(this.isReplaced=!0),this.options.data=null,this.load(e)))},enable:function(){this.isBuilt&&(this.isDisabled=!1,this.$cropper.removeClass(R))},disable:function(){this.isBuilt&&(this.isDisabled=!0,this.$cropper.addClass(R))},destroy:function(){var e=this.$element;this.isLoaded?(this.isImg&&this.isReplaced&&e.attr("src",this.originalUrl),this.unbuild(),e.removeClass(T)):this.isImg?e.off(U,this.start):this.$clone&&this.$clone.remove(),e.removeData(L)},move:function(e,t){var o=this.canvas;this.moveTo(i(e)?e:o.left+le(e),i(t)?t:o.top+le(t))},moveTo:function(t,o){var a=this.canvas,n=!1;i(o)&&(o=t),t=le(t),o=le(o),this.isBuilt&&!this.isDisabled&&this.options.movable&&(e(t)&&(a.left=t,n=!0),e(o)&&(a.top=o,n=!0),n&&this.renderCanvas(!0))},zoom:function(e,t){var i=this.canvas;e=le(e),e=0>e?1/(1-e):1+e,this.zoomTo(i.width*e/i.naturalWidth,t)},zoomTo:function(e,t){var i,o,a,n,r,s=this.options,d=this.canvas,p=d.width,h=d.height,l=d.naturalWidth,g=d.naturalHeight;if(e=le(e),0<=e&&this.isBuilt&&!this.isDisabled&&s.zoomable){if(o=l*e,a=g*e,t&&(i=t.originalEvent),this.trigger(Z,{originalEvent:i,oldRatio:p/l,ratio:o/l}).isDefaultPrevented())return;i?(n=this.$cropper.offset(),r=i.touches?c(i.touches):{pageX:t.pageX||i.pageX||0,pageY:t.pageY||i.pageY||0},d.left-=(o-p)*((r.pageX-n.left-d.left)/p),d.top-=(a-h)*((r.pageY-n.top-d.top)/h)):(d.left-=(o-p)/2,d.top-=(a-h)/2),d.width=o,d.height=a,this.renderCanvas(!0)}},rotate:function(e){this.rotateTo((this.image.rotate||0)+le(e))},rotateTo:function(t){t=le(t),e(t)&&this.isBuilt&&!this.isDisabled&&this.options.rotatable&&(this.image.rotate=t%360,this.isRotated=!0,this.renderCanvas(!0))},scale:function(t,o){var a=this.image,n=!1;i(o)&&(o=t),t=le(t),o=le(o),this.isBuilt&&!this.isDisabled&&this.options.scalable&&(e(t)&&(a.scaleX=t,n=!0),e(o)&&(a.scaleY=o,n=!0),n&&this.renderImage(!0))},scaleX:function(t){var i=this.image.scaleY;this.scale(t,e(i)?i:1)},scaleY:function(t){var i=this.image.scaleX;this.scale(e(i)?i:1,t)},getData:function(e){var o,a,n=this.options,r=this.image,s=this.canvas,d=this.cropBox;return this.isBuilt&&this.isCropped?(a={x:d.left-s.left,y:d.top-s.top,width:d.width,height:d.height},o=r.width/r.naturalWidth,t.each(a,function(t,i){i/=o,a[t]=e?we(i):i})):a={x:0,y:0,width:0,height:0},n.rotatable&&(a.rotate=r.rotate||0),n.scalable&&(a.scaleX=r.scaleX||1,a.scaleY=r.scaleY||1),a},setData:function(i){var o,a,n,r=this.options,s=this.image,d=this.canvas,p={};t.isFunction(i)&&(i=i.call(this.element)),this.isBuilt&&!this.isDisabled&&t.isPlainObject(i)&&(r.rotatable&&e(i.rotate)&&i.rotate!==s.rotate&&(s.rotate=i.rotate,this.isRotated=o=!0),r.scalable&&(e(i.scaleX)&&i.scaleX!==s.scaleX&&(s.scaleX=i.scaleX,a=!0),e(i.scaleY)&&i.scaleY!==s.scaleY&&(s.scaleY=i.scaleY,a=!0)),o?this.renderCanvas():a&&this.renderImage(),n=s.width/s.naturalWidth,e(i.x)&&(p.left=i.x*n+d.left),e(i.y)&&(p.top=i.y*n+d.top),e(i.width)&&(p.width=i.width*n),e(i.height)&&(p.height=i.height*n),this.setCropBoxData(p))},getContainerData:function(){return this.isBuilt?this.container:{}},getImageData:function(){return this.isLoaded?this.image:{}},getCanvasData:function(){var e=this.canvas,o={};return this.isBuilt&&t.each(["left","top","width","height","naturalWidth","naturalHeight"],function(t,i){o[i]=e[i]}),o},setCanvasData:function(i){var o=this.canvas,a=o.aspectRatio;t.isFunction(i)&&(i=i.call(this.$element)),this.isBuilt&&!this.isDisabled&&t.isPlainObject(i)&&(e(i.left)&&(o.left=i.left),e(i.top)&&(o.top=i.top),e(i.width)?(o.width=i.width,o.height=i.width/a):e(i.height)&&(o.height=i.height,o.width=i.height*a),this.renderCanvas(!0))},getCropBoxData:function(){var e,t=this.cropBox;return this.isBuilt&&this.isCropped&&(e={left:t.left,top:t.top,width:t.width,height:t.height}),e||{}},setCropBoxData:function(i){var o,a,n=this.cropBox,r=this.options.aspectRatio;t.isFunction(i)&&(i=i.call(this.$element)),this.isBuilt&&this.isCropped&&!this.isDisabled&&t.isPlainObject(i)&&(e(i.left)&&(n.left=i.left),e(i.top)&&(n.top=i.top),e(i.width)&&(o=!0,n.width=i.width),e(i.height)&&(a=!0,n.height=i.height),r&&(o?n.height=n.width/r:a&&(n.width=n.height*r)),this.renderCropBox())},getCroppedCanvas:function(e){var i,o,a,n,r,s,d,p,h,c,g;if(this.isBuilt&&pe)return this.isCropped?(t.isPlainObject(e)||(e={}),g=this.getData(),i=g.width,o=g.height,p=i/o,t.isPlainObject(e)&&(r=e.width,s=e.height,r?(s=r/p,d=r/i):s&&(r=s*p,d=s/o)),a=ve(r||i),n=ve(s||o),h=t("<canvas>")[0],h.width=a,h.height=n,c=h.getContext("2d"),e.fillColor&&(c.fillStyle=e.fillColor,c.fillRect(0,0,a,n)),c.drawImage.apply(c,function(){var e,t,a,n,r,s,p=l(this.$clone[0],this.image),h=p.width,c=p.height,m=this.canvas,f=[p],u=g.x+m.naturalWidth*(me(g.scaleX||1)-1)/2,x=g.y+m.naturalHeight*(me(g.scaleY||1)-1)/2;return u<=-i||u>h?u=e=a=r=0:0>=u?(a=-u,u=0,e=r=ce(h,i+u)):u<=h&&(a=0,e=r=ce(i,h-u)),0>=e||x<=-o||x>c?x=t=n=s=0:0>=x?(n=-x,x=0,t=s=ce(c,o+x)):x<=c&&(n=0,t=s=ce(o,c-x)),f.push(ve(u),ve(x),ve(e),ve(t)),d&&(a*=d,n*=d,r*=d,s*=d),0<r&&0<s&&f.push(ve(a),ve(n),ve(r),ve(s)),f}.call(this)),h):l(this.$clone[0],this.image)},setAspectRatio:function(e){var t=this.options;this.isDisabled||i(e)||(t.aspectRatio=ge(0,e)||NaN,this.isBuilt&&(this.initCropBox(),this.isCropped&&this.renderCropBox()))},setDragMode:function(e){var t,i,o=this.options;this.isLoaded&&!this.isDisabled&&(t=e===re,i=o.movable&&e===se,e=t||i?e:"none",this.$dragBox.data(G,e).toggleClass(H,t).toggleClass(W,i),!o.cropBoxMovable&&this.$face.data(G,e).toggleClass(H,t).toggleClass(W,i))}},x.DEFAULTS={viewMode:0,dragMode:"crop",aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:450,minContainerHeight:600,build:null,built:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},x.setDefaults=function(e){t.extend(x.DEFAULTS,e)},x.TEMPLATE="<div class=\"cropper-container\"><div class=\"cropper-wrap-box\"><div class=\"cropper-canvas\"></div></div><div class=\"cropper-drag-box\"></div><div class=\"cropper-crop-box\"><span class=\"cropper-view-box\"></span><span class=\"cropper-dashed dashed-h\"></span><span class=\"cropper-dashed dashed-v\"></span><span class=\"cropper-center\"></span><span class=\"cropper-face\"></span><span class=\"cropper-line line-e\" data-action=\"e\"></span><span class=\"cropper-line line-n\" data-action=\"n\"></span><span class=\"cropper-line line-w\" data-action=\"w\"></span><span class=\"cropper-line line-s\" data-action=\"s\"></span><span class=\"cropper-point point-e\" data-action=\"e\"></span><span class=\"cropper-point point-n\" data-action=\"n\"></span><span class=\"cropper-point point-w\" data-action=\"w\"></span><span class=\"cropper-point point-s\" data-action=\"s\"></span><span class=\"cropper-point point-ne\" data-action=\"ne\"></span><span class=\"cropper-point point-nw\" data-action=\"nw\"></span><span class=\"cropper-point point-sw\" data-action=\"sw\"></span><span class=\"cropper-point point-se\" data-action=\"se\"></span></div></div>",x.other=t.fn.cropper,t.fn.cropper=function(e){var a,n=o(arguments,1);return this.each(function(){var i,o,r=t(this),s=r.data(L);if(!s){if(/destroy/.test(e))return;i=t.extend({},r.data(),t.isPlainObject(e)&&e),r.data(L,s=new x(this,i))}"string"==typeof e&&t.isFunction(o=s[e])&&(a=o.apply(s,n))}),i(a)?this:a},t.fn.cropper.Constructor=x,t.fn.cropper.setDefaults=x.setDefaults,t.fn.cropper.noConflict=function(){return t.fn.cropper=x.other,this}});
